<html lang="ko">
  <head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>수업9_실습1_웹페이지 만들기</title>
    <!-- axios 사용을 위한 cdn -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <link rel="stylesheet" href="../static/css/style_regi.css" />
  </head>
  <body>
    <h1 class="naverlogo">
      <a class="link" href="http://www.naver.com">
        <img class="logo" src="../static/img/naverlogo.png" />
      </a>
    </h1>
    <content>
      <main class="register">
        <div class="content">
          <form name="userregi">
            <div class="border id">
              <i class="bi bi-person"></i>
              <input type="text" class="inputid" id="inputId" name="userid" placeholder="아이디" />

            </div>
            <div class="border name">
              <i class="bi bi-person"></i>
              <input type="text" class="inputname" id="inputName" name="username" placeholder="이름" />

            </div>
            <div class="border pw">
              <i class="bi bi-lock"></i>
              <input type="password" class="inputpw" id="inputPw" name="userpw" placeholder="비밀번호" />

            </div>
        </div>
        </form>
        </div>
        <!-- <nav class="nav-login"> -->
        <div class="d-grid gap-2 col-6 mx-auto">
          <div class="regi-result"></div>
          <button class="btn btn-success" type="button" onclick="clickRegister()">
            회원가입
          </button>
        </div>
        <!-- </nav> -->
        </div>
      </main>
    </content>
  </body>
  <script> 
    // tip : 함수들 순서도 중요했다..! 버튼에 선언한 함수를 가장 상단에 두었더니 계속 오류가 나서,
    // 순서를 바꿨더니 바로 해결이 되었다.
    // 나의 생각 알고리즘..
    // 1. 아이콘 만들기
    // 2. 텍스트가 입력된다 -> 입력을 감지하면 아이콘을 숨긴다.
    // 3. 아이콘을 숨기려면, 활성화됐을 때 숨기는 함수 필요


    // 로그인 버튼 함수
    function clickRegister() {
      const form = document.forms['userregi'];
      const data = {
        userid: form.userid.value,
        userpw: form.userpw.value,
      };

      axios({
        method: 'POST',
        url: 'user/register',
        data: data,
      }).then((res) => {
        const {
          isSuccess,
          msg
        } = res.data;
        console.log(isSuccess);
        const element = document.querySelector('.regi-result');
        element.innerHTML = msg;

        const color = isSuccess ? 'blue' : 'red';
        element.style.color = color;
      });
    }
  </script>
</html>